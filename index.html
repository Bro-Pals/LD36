<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<script src="lib/gamethings.js"></script>
	<script src="gamecode.js"></script>
	<script type="x-shader/x-vertex" id="vshader">
		attribute vec2 vertexPos; //Raw vertex data
		attribute vec2 texCoord; //Raw texture coordinate data 
		varying mediump vec2 varyingTexCoord; 
		uniform vec2 worldPosition; //Position of object in game world (World coordinates) 
		uniform vec2 worldSize; //(width, height) of object in game world (World coordinates)
		uniform vec2 screenSize; //(width, height) of the game screen in screen coordinates 
		//*The size of the view for world coordinates is the same scale as screen coordinates*
		
		void main() {
			varyingTexCoord = texCoord; //Pass it on to the fragment shader 
			gl_Position = vec4(
				//Formula transforms the raw coordinate (vertexPos)
				//to world coordinates (worldPosition and worldSize) and then to NDC
				((2.0*worldSize.x*vertexPos.x)+(2.0*worldPosition.x)+(worldSize.x))/screenSize.x - 1.0,
				((2.0*worldSize.y*vertexPos.y)+(2.0*worldPosition.y)+(worldSize.y))/screenSize.y - 1.0,
				0.0, 1.0
			);
		}
		
	</script>
	<script type="x-shader/x-fragment" id="fshader">
		//Need to give a precision if it isn't GL_ES (?)

		varying mediump vec2 varyingTexCoord;
		uniform sampler2D tex; //Sampler for the texture 
		
		void main() {
			gl_FragColor = texture2D(tex, varyingTexCoord); //Get the texture 
		}
		
	</script>
</head>
<body onload="startGame()">
	<!--Our game canvas!-->
	<canvas width="800" height="500" id="gamecanvas"></script>
	<script>
		function startGame() {
			GameManager.createState(
				"mainMenu",
				initMainMenu,
				updateMainMenu,
				renderMainMenu,
					{
					key : keyMainMenu,
					mouse : mouseMainMenu,
					mouseMove : mouseMoveMainMenu
					}
				);
			GameManager.createState(
				"storyBoard",
				initStoryBoard,
				updateStoryBoard,
				renderStoryBoard,
					{
					key : keyStoryBoard,
					mouse : mouseStoryBoard,
					mouseMove : mouseMoveStoryBoard
					}
				);
			GameManager.createState(
				"playGame",
				initPlayGame,
				updatePlayGame,
				renderPlayGame,
					{
					key : keyPlayGame,
					mouse : mousePlayGame,
					mouseMove : mouseMovePlayGame
					}
				);
			GameManager.setCanvas("gamecanvas", "webgl");
			initWebGLParts();
			GameManager.setState("mainMenu");
			GameManager.loop();
		}
	</script>
</body>
</html>